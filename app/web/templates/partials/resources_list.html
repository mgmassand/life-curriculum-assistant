{% if resources %}
{% for resource in resources %}
<div class="bg-white rounded-lg shadow overflow-hidden hover:shadow-md transition-shadow">
    <!-- Resource Card Header -->
    <div class="p-4">
        <div class="flex items-start justify-between mb-2">
            <div class="flex items-center gap-2">
                <!-- Type Icon -->
                {% if resource.resource_type == 'article' %}
                <span class="text-blue-500" title="Article">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"/>
                    </svg>
                </span>
                {% elif resource.resource_type == 'video' %}
                <span class="text-red-500" title="Video">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"/>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                    </svg>
                </span>
                {% elif resource.resource_type == 'guide' %}
                <span class="text-green-500" title="Guide">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"/>
                    </svg>
                </span>
                {% elif resource.resource_type == 'book' %}
                <span class="text-purple-500" title="Book">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"/>
                    </svg>
                </span>
                {% else %}
                <span class="text-gray-500" title="Tool">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                    </svg>
                </span>
                {% endif %}
                <span class="text-xs text-gray-500 capitalize">{{ resource.resource_type }}</span>
                {% if resource.is_featured %}
                <span class="px-2 py-0.5 bg-yellow-100 text-yellow-700 text-xs rounded-full">Featured</span>
                {% endif %}
            </div>

            <!-- Bookmark Button -->
            <button onclick="toggleBookmark('{{ resource.id }}', this)"
                    data-bookmarked="{{ 'true' if resource.is_bookmarked else 'false' }}"
                    class="p-1 hover:bg-gray-100 rounded transition-colors"
                    title="{{ 'Remove bookmark' if resource.is_bookmarked else 'Add bookmark' }}">
                <svg class="w-5 h-5 {{ 'text-indigo-600' if resource.is_bookmarked else 'text-gray-400' }}" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"/>
                </svg>
            </button>
        </div>

        <!-- Title -->
        <h3 class="font-semibold text-gray-900 mb-2 line-clamp-2">{{ resource.title }}</h3>

        <!-- Description -->
        <p class="text-sm text-gray-600 mb-3 line-clamp-3">{{ resource.description }}</p>

        <!-- Tags -->
        {% if resource.domain_names %}
        <div class="flex flex-wrap gap-1 mb-3">
            {% for domain_name in resource.domain_names[:2] %}
            <span class="px-2 py-0.5 bg-gray-100 text-gray-600 text-xs rounded">{{ domain_name }}</span>
            {% endfor %}
        </div>
        {% endif %}

        <!-- Age Stages -->
        {% if resource.age_stage_names %}
        <div class="text-xs text-gray-500 mb-3">
            <span class="font-medium">Ages:</span>
            {{ resource.age_stage_names[:3] | join(', ') }}{% if resource.age_stage_names | length > 3 %}, +{{ resource.age_stage_names | length - 3 }} more{% endif %}
        </div>
        {% endif %}
    </div>

    <!-- Card Footer -->
    <div class="px-4 py-3 bg-gray-50 border-t border-gray-100">
        {% if resource.url %}
        <a href="{{ resource.url }}" target="_blank" rel="noopener noreferrer"
           class="inline-flex items-center text-sm font-medium text-indigo-600 hover:text-indigo-700">
            View Resource
            <svg class="ml-1 w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"/>
            </svg>
        </a>
        {% else %}
        <span class="text-sm text-gray-500">Content available in app</span>
        {% endif %}

        {% if resource.view_count > 0 %}
        <span class="float-right text-xs text-gray-400">{{ resource.view_count }} views</span>
        {% endif %}
    </div>
</div>
{% endfor %}

<!-- Pagination Info -->
{% if total > page_size %}
<div class="col-span-full mt-6 flex items-center justify-between">
    <p class="text-sm text-gray-500">
        Showing {{ (page - 1) * page_size + 1 }}-{{ [page * page_size, total] | min }} of {{ total }} resources
    </p>
    <div class="flex gap-2">
        {% if page > 1 %}
        <button hx-get="/api/resources?page={{ page - 1 }}&page_size={{ page_size }}"
                hx-target="#resources-grid"
                hx-swap="innerHTML"
                class="px-3 py-1.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50">
            Previous
        </button>
        {% endif %}
        {% if page < total_pages %}
        <button hx-get="/api/resources?page={{ page + 1 }}&page_size={{ page_size }}"
                hx-target="#resources-grid"
                hx-swap="innerHTML"
                class="px-3 py-1.5 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700">
            Next
        </button>
        {% endif %}
    </div>
</div>
{% endif %}

{% else %}
<div class="col-span-full bg-white rounded-lg shadow p-8 text-center">
    <div class="text-gray-400 text-4xl mb-4">ðŸ“š</div>
    <h3 class="font-medium text-gray-900 mb-2">No resources found</h3>
    <p class="text-gray-500">Try adjusting your filters or search terms.</p>
</div>
{% endif %}
